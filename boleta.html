<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Boleta - Cine Kong</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
<style>
  body{font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#fff9d6;margin:0;display:flex;align-items:center;justify-content:center;height:100vh}
  .ticket{background:#fff;border-radius:16px;padding:22px;width:360px;box-shadow:0 12px 30px rgba(0,0,0,.12);border:2px dashed #f0d000}
  .logo{display:block;margin:0 auto 10px;width:120px}
  .label{font-weight:700;color:#444;font-size:0.9rem}
  .value{background:#fff8d9;padding:8px;border-radius:8px;margin-top:6px;border:1px solid #eee}
  .qr{display:flex;justify-content:center;margin-top:14px}
  .actions{display:flex;gap:10px;justify-content:center;margin-top:14px}
  button{background:#f0d000;border:none;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
  @media print{button{display:none}}
</style>
</head>
<body>
  <div class="ticket">
    <img class="logo" src="https://lupitalamejorperrita-bot.github.io/prueba/Cine_Logo.jpg" alt="Cine Kong">
    <h3 style="text-align:center;margin:0 0 8px">Boleta — Cine Kong</h3>

    <div>
      <div class="label">Película</div>
      <div id="pelicula" class="value">—</div>
    </div>
    <div style="margin-top:8px">
      <div class="label">Fecha y hora</div>
      <div id="fecha" class="value">—</div>
    </div>
    <div style="margin-top:8px">
      <div class="label">Titular</div>
      <div id="nombre" class="value">—</div>
    </div>
    <div style="margin-top:8px">
      <div class="label">Asiento</div>
      <div id="asiento" class="value">—</div>
    </div>

    <div class="qr">
      <canvas id="qrCanvas"></canvas>
    </div>

    <div style="font-size:12px;color:#666;text-align:center;margin-top:8px">Escanea para validar esta boleta</div>

    <div class="actions">
      <button onclick="window.print()">Imprimir</button>
      <button onclick="window.location.href='index.html'">Volver</button>
    </div>
  </div>

<script>
  // Obtener parámetros de la URL
  const params = new URLSearchParams(window.location.search);
  const pelicula = params.get('pelicula') || '—';
  const fecha = params.get('fecha') || '—';
  const hora = params.get('hora') || '—';
  const nombre = params.get('nombre') || '—';
  const asiento = params.get('asiento') || '—';

  // Mostrar datos en pantalla
  document.getElementById('pelicula').textContent = pelicula;
  document.getElementById('fecha').textContent = (fecha && hora) ? `${fecha} — ${hora}` : fecha || hora || '—';
  document.getElementById('nombre').textContent = nombre;
  document.getElementById('asiento').textContent = asiento;

  // Generar un código único (más largo para reducir colisiones)
  // Puedes reemplazar por un ID que provenga de tu backend si llegas a tenerlo.
  const codigo = (params.get('codigo')) ? params.get('codigo') : (Date.now().toString(36) + Math.random().toString(36).slice(2,8));

  // Construir URL de validación pública (apunta al GitHub Pages donde subirás validar.html)
  // Cambia la base si tu repo usa otro path.
  const validarBase = 'https://lupitalamejorperrita-bot.github.io/prueba/CineKong/validar.html';
  const urlValidacion = `${validarBase}?codigo=${encodeURIComponent(codigo)}`;

  // Crear QR con QRious
  new QRious({
    element: document.getElementById('qrCanvas'),
    value: urlValidacion,
    size: 180,
    background: '#fff',
    foreground: '#000'
  });

  // También incluimos el código como texto debajo del QR (útil para pruebas manuales)
  const txt = document.createElement('div');
  txt.style.textAlign = 'center';
  txt.style.marginTop = '8px';
  txt.style.fontSize = '12px';
  txt.style.color = '#444';
  txt.textContent = `Código: ${codigo}`;
  document.querySelector('.ticket').appendChild(txt);
</script>
</body>
</html>